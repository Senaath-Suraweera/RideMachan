<!-- ===================
     Sidebar Navigation Component
=================== -->
<div class="sidebar">
  <div class="logo">
    <img src="../images/logo.png" alt="Ride Machan Logo" class="logo" />
  </div>
  <div class="nav-menu">
    <div class="nav-item" data-page="home">
      <i class="fas fa-house"></i>
      <a href="../pages/home.html"><span>Home</span></a>
    </div>
    <div class="nav-item" data-page="search">
      <i class="fas fa-car"></i>
      <a href="../pages/search.html"><span>Search</span></a>
    </div>
    <div class="nav-item" data-page="bookings">
      <i class="fas fa-calendar-check"></i>
      <a href="../pages/bookings.html"><span>Bookings</span></a>
    </div>
    <div class="nav-item" data-page="notifications">
      <i class="fas fa-bell"></i>
      <a href="../pages/notifications.html"><span>Notifications</span></a>
    </div>
    <div class="logout" onclick="handleLogout()">
      <i class="fas fa-sign-out-alt"></i>
      <span>Logout</span>
    </div>
  </div>
</div>

<style>
  /* Sidebar Styles */
  .sidebar {
    grid-row: 1 / 3;
    background-color: rgba(14, 21, 43, 0.94);
    color: white;
    overflow-y: auto;
    transition: var(--transition);
    box-shadow: var(--shadow);
    z-index: 1000;
    position: fixed;
    height: 100%;
    width: var(--sidebar-width);
  }

  .sidebar::before {
    content: "";
    position: absolute;
    top: 0;
    right: 0;
    height: 100%;
    width: 1px;
    background: linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0.1),
      transparent
    );
  }

  /* Logo Styles */
  .logo {
    width: 120px;
    height: 150px;
    margin-left: 2.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .logo img {
    width: 100%;
    height: auto;
    display: block;
    margin: 0 auto;
  }

  /* Navigation Menu */
  .nav-menu {
    padding: 10px 0;
  }

  .nav-item {
    padding: 12px 25px;
    display: flex;
    align-items: center;
    cursor: pointer;
    transition: var(--transition);
    border-left: 4px solid transparent;
    margin: 4px 0;
    border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
    position: relative;
    overflow: hidden;
  }

  .nav-item::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 1px;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.2),
      transparent
    );
    transition: var(--transition);
  }

  .nav-item a {
    color: rgba(255, 255, 255, 0.8);
    text-decoration: none;
    font-weight: 500;
  }

  .nav-item:hover::after {
    width: 100%;
  }

  .nav-item:hover,
  .nav-item.active {
    background-color: rgba(255, 255, 255, 0.07);
    border-left: 5px solid rgba(255, 255, 255, 0.241);
  }

  .nav-item.active {
    background: linear-gradient(90deg, rgba(67, 97, 238, 0.2), transparent);
    font-weight: 500;
  }

  .nav-item.active a {
    color: white;
  }

  .nav-item i {
    width: 24px;
    margin-right: 12px;
    font-size: 18px;
    text-align: center;
    transition: var(--transition);
  }

  .nav-item:hover i {
    transform: translateY(-2px);
  }

  /* Logout Button */
  .logout {
    position: fixed;
    bottom: 20px;
    left: 20px;
    padding-right: 10px;
    margin-left: 20px;
    display: flex;
    align-items: center;
    cursor: pointer;
    transition: var(--transition);
    border-left: 4px solid transparent;
    border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
    overflow: hidden;
    color: rgba(255, 255, 255, 0.8);
  }

  .logout::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 1px;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.2),
      transparent
    );
    transition: var(--transition);
  }

  .logout:hover::after {
    width: 100%;
  }

  .logout:hover {
    background-color: rgba(244, 34, 34, 0.07);
    border-left: 5px solid rgba(231, 50, 50, 0.241);
    color: white;
  }

  .logout i {
    width: 24px;
    margin-right: 12px;
    font-size: 18px;
    text-align: center;
    transition: var(--transition);
  }

  .logout:hover i {
    transform: translateY(-2px);
  }

  .logout span {
    font-weight: 500;
  }

  /* Mobile Menu Toggle */
  .mobile-menu-toggle {
    display: none;
    position: fixed;
    top: 15px;
    left: 15px;
    z-index: 1002;
    background: var(--primary);
    color: white;
    border: none;
    padding: 10px;
    border-radius: 5px;
    cursor: pointer;
  }

  @media (max-width: 992px) {
    .mobile-menu-toggle {
      display: block;
    }

    .sidebar {
      transform: translateX(-100%);
    }

    .sidebar.active {
      transform: translateX(0);
    }
  }
</style>

<script>
  // Navigation functionality
  function initializeNavbar() {
    // Set active nav item based on current page
    const currentPage = getCurrentPageName();
    setActiveNavItem(currentPage);

    // Mobile menu toggle
    setupMobileMenu();
  }

  function getCurrentPageName() {
    const path = window.location.pathname;
    const page = path.substring(path.lastIndexOf("/") + 1);
    return page.replace(".html", "") || "home";
  }

  function setActiveNavItem(pageName) {
    // Remove active class from all nav items
    document.querySelectorAll(".nav-item").forEach((item) => {
      item.classList.remove("active");
    });

    // Add active class to current page nav item
    const activeItem = document.querySelector(`[data-page="${pageName}"]`);
    if (activeItem) {
      activeItem.classList.add("active");
    }
  }

  function setupMobileMenu() {
    // Create mobile menu toggle if it doesn't exist
    if (!document.querySelector(".mobile-menu-toggle")) {
      const toggleBtn = document.createElement("button");
      toggleBtn.className = "mobile-menu-toggle";
      toggleBtn.innerHTML = '<i class="fas fa-bars"></i>';
      toggleBtn.onclick = toggleSidebar;
      document.body.appendChild(toggleBtn);
    }
  }

  function toggleSidebar() {
    const sidebar = document.querySelector(".sidebar");
    sidebar.classList.toggle("active");
  }

  function handleLogout() {
    if (confirm("Are you sure you want to logout?")) {
      // Call backend servlet
      fetch("/customer/logout", { method: "GET" })
        .then((response) => {
          // Follow redirect from servlet
          if (response.redirected) {
            window.location.href = response.url;
          } else {
            // Manual fallback
            window.location.href = "/views/landing/index.html";
          }
        })
        .catch((error) => {
          console.error("Logout failed:", error);
          window.location.href = "/views/landing/index.html";
        });
    }
  }

  // Initialize when DOM is loaded
  document.addEventListener("DOMContentLoaded", initializeNavbar);

  // Close sidebar when clicking outside on mobile
  document.addEventListener("click", function (event) {
    const sidebar = document.querySelector(".sidebar");
    const toggleBtn = document.querySelector(".mobile-menu-toggle");

    if (
      window.innerWidth <= 992 &&
      !sidebar.contains(event.target) &&
      !toggleBtn.contains(event.target) &&
      sidebar.classList.contains("active")
    ) {
      sidebar.classList.remove("active");
    }
  });
</script>
