<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Payment - Vehicle Booking</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="stylesheet" href="../css/payment.css" />
</head>
<body>
    <div class="container">
        <!-- Include Sidebar Navigation -->
        <div class="sidebar">
            <div class="logo">
                <img src="../images/logo.png" alt="Ride Machan Logo" class="logo">
            </div>
            <div class="nav-menu">
                <div class="nav-item" data-page="home">
                    <i class="fas fa-house"></i>
                    <a href="dashboard.html"><span>Home</span></a>
                </div>
                <div class="nav-item" data-page="search">
                    <i class="fas fa-car"></i>
                    <a href="search.html"><span>Search</span></a>
                </div>
                <div class="nav-item active" data-page="bookings">
                    <i class="fas fa-calendar-check"></i>
                    <a href="bookings.html"><span>Bookings</span></a>
                </div>
                <div class="nav-item" data-page="settings">
                    <i class="fas fa-cog"></i>
                    <a href="settings.html"><span>Settings</span></a>
                </div>
                <div class="nav-item" data-page="notifications">
                    <i class="fas fa-bell"></i>
                    <a href="notifications.html"><span>Notifications</span></a>
                </div>
                <div class="logout" onclick="handleLogout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </div>
            </div>
        </div>

        <!-- Header Section -->
        <div class="header">
            <div class="back-to-booking">
                <i class="fas fa-arrow-left"></i>
                <span onclick="goBackToBooking()">Back to Booking</span>
            </div>
            <div class="header-actions">
                <div class="notification" onclick="showNotifications()">
                    <i class="fas fa-bell"></i>
                    <div class="badge" id="notificationCount">3</div>
                </div>
                <div class="notification" onclick="showMessages()">
                    <i class="fas fa-envelope"></i>
                    <div class="badge" id="messageCount">5</div>
                </div>
                <div class="user-profile" onclick="toggleProfileDropdown()">
                    <div class="profile-img" id="profileInitial">K</div>
                    <div class="user-info">
                        <div class="user-name" id="userName">Kamal</div>
                    </div>
                    <div class="profile-dropdown" id="profileDropdown">
                        <a href="profile.html"><i class="fas fa-user"></i> My Profile</a>
                        <a href="settings.html"><i class="fas fa-cog"></i> Settings</a>
                        <a href="bookings.html"><i class="fas fa-calendar"></i> My Bookings</a>
                        <hr>
                        <a href="#" onclick="handleLogout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="main-content">
            <div class="payment-container">
                <!-- Booking Summary Section -->
                <div class="booking-summary">
                    <div class="section-header">
                        <i class="fas fa-list"></i>
                        <h3>Booking Summary</h3>
                    </div>
                    
                    <div class="vehicle-info">
                        <div class="vehicle-icon">
                            <i class="fas fa-car"></i>
                        </div>
                        <div class="vehicle-details">
                            <h4>Suzuki Alto</h4>
                            <p>Self Drive</p>
                            <span class="company">Company: Budget Car Rental</span>
                        </div>
                    </div>

                    <div class="schedule-details">
                        <h4>Schedule Details</h4>
                        <div class="detail-row">
                            <span class="label">Date:</span>
                            <span class="value">8/20/2024</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Time:</span>
                            <span class="value">09:00</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Duration:</span>
                            <span class="value">Full-Day</span>
                        </div>
                    </div>

                    <div class="pricing-details">
                        <h4>Pricing Details</h4>
                        <div class="price-row">
                            <span class="label">Base Rate:</span>
                            <span class="value">LKR 1,000/hour</span>
                        </div>
                        <div class="price-row">
                            <span class="label">Service Fee:</span>
                            <span class="value">LKR 500</span>
                        </div>
                        <div class="price-row total">
                            <span class="label">Total Amount:</span>
                            <span class="value">LKR 8,000</span>
                        </div>
                    </div>
                </div>

                <!-- Payment Information Section -->
                <div class="payment-information">
                    <div class="section-header">
                        <i class="fas fa-credit-card"></i>
                        <h3>Payment Information</h3>
                    </div>
                    <p class="section-subtitle">Complete your payment to confirm your booking</p>

                    <form class="payment-form" onsubmit="processPayment(event)">
                        <div class="form-group">
                            <label for="payment-method">Payment Method</label>
                            <select id="payment-method" name="payment-method">
                                <option value="credit-debit">Credit/Debit Card</option>
                                <option value="paypal">PayPal</option>
                                <option value="bank-transfer">Bank Transfer</option>
                            </select>
                        </div>

                        <div class="card-details-section">
                            <h4><i class="fas fa-credit-card"></i> Card Details</h4>
                            
                            <div class="form-group">
                                <label for="card-number">Card Number</label>
                                <input type="text" id="card-number" name="card-number" placeholder="1234 5678 9012 3456" required />
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="expiry-date">Expiry Date</label>
                                    <input type="text" id="expiry-date" name="expiry-date" placeholder="MM/YY" required />
                                </div>
                                <div class="form-group">
                                    <label for="cvv">CVV</label>
                                    <input type="text" id="cvv" name="cvv" placeholder="123" required />
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="cardholder-name">Cardholder Name</label>
                                <input type="text" id="cardholder-name" name="cardholder-name" placeholder="John Doe" required />
                            </div>
                        </div>

                        <div class="contact-information">
                            <h4>Contact Information</h4>
                            
                            <div class="form-group">
                                <label for="email">Email Address</label>
                                <input type="email" id="email" name="email" placeholder="john@example.com" required />
                            </div>

                            <div class="form-group">
                                <label for="phone">Phone Number</label>
                                <input type="tel" id="phone" name="phone" placeholder="+94 77 123 4567" required />
                            </div>
                        </div>

                        <div class="security-notice">
                            <div class="security-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="security-text">
                                <h5>Secure Payment</h5>
                                <p>Your payment information is encrypted and secure. We never store your card details.</p>
                            </div>
                        </div>

                        <button type="submit" class="pay-button">
                            <i class="fas fa-lock"></i>
                            Pay LKR 8,000
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Navigation functionality
        function initializeNavbar() {
            const currentPage = getCurrentPageName();
            setActiveNavItem(currentPage);
            setupMobileMenu();
        }

        function getCurrentPageName() {
            const path = window.location.pathname;
            const page = path.substring(path.lastIndexOf('/') + 1);
            return page.replace('.html', '') || 'home';
        }

        function setActiveNavItem(pageName) {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const activeItem = document.querySelector(`[data-page="${pageName}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }
        }

        function setupMobileMenu() {
            if (!document.querySelector('.mobile-menu-toggle')) {
                const toggleBtn = document.createElement('button');
                toggleBtn.className = 'mobile-menu-toggle';
                toggleBtn.innerHTML = '<i class="fas fa-bars"></i>';
                toggleBtn.onclick = toggleSidebar;
                document.body.appendChild(toggleBtn);
            }
        }

        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            sidebar.classList.toggle('active');
        }

        // Header functionality
        function initializeHeader() {
            loadUserData();
            updateNotificationCounts();
            
            document.addEventListener('click', function(event) {
                const dropdown = document.getElementById('profileDropdown');
                const profile = document.querySelector('.user-profile');
                
                if (!profile.contains(event.target)) {
                    dropdown.classList.remove('show');
                }
            });
        }

        function loadUserData() {
            const userData = {
                name: 'Kamal Silva',
                email: 'kamal@example.com',
                phone: '+94 77 123 4567',
                initial: 'K'
            };
            
            document.getElementById('userName').textContent = userData.name.split(' ')[0];
            document.getElementById('profileInitial').textContent = userData.initial;
        }

        function updateNotificationCounts() {
            const counts = {
                notifications: 3,
                messages: 5
            };
            
            document.getElementById('notificationCount').textContent = counts.notifications;
            document.getElementById('messageCount').textContent = counts.messages;
            
            if (counts.notifications === 0) {
                document.getElementById('notificationCount').style.display = 'none';
            }
            if (counts.messages === 0) {
                document.getElementById('messageCount').style.display = 'none';
            }
        }

        
    function goBackToBooking() {
        if (document.referrer && document.referrer !== window.location.href) {
            window.history.back();
        } else {
            window.location.href = 'bookings.html';
        }
    }



        function toggleProfileDropdown() {
            const dropdown = document.getElementById('profileDropdown');
            dropdown.classList.toggle('show');
        }

        function showNotifications() {
            window.location.href = 'notifications.html';
        }

        function showMessages() {
            showPopup('Messages', 'Messages feature coming soon!', 'info');
        }

        function handleLogout() {
            if (confirm('Are you sure you want to logout?')) {
                showLogoutMessage();
                
                setTimeout(() => {
                    window.location.href = '../auth/login.html';
                }, 1500);
            }
        }

        function showLogoutMessage() {
            const notification = document.createElement('div');
            notification.innerHTML = `
                <div style="
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--success);
                    color: white;
                    padding: 15px 20px;
                    border-radius: var(--radius);
                    box-shadow: var(--shadow);
                    z-index: 9999;
                    animation: slideIn 0.3s ease;
                ">
                    <i class="fas fa-check-circle"></i>
                    Logged out successfully!
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 1200);
        }

        

        function processPayment(event) {
            event.preventDefault();
            
            // Show processing animation
            const payButton = document.querySelector('.pay-button');
            const originalText = payButton.innerHTML;
            payButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            payButton.disabled = true;
            
            // Simulate payment processing
            setTimeout(() => {
                showPaymentSuccess();
                setTimeout(() => {
                    window.location.href = 'payment_status.html';
                }, 2000);
            }, 3000);
        }

        function showPaymentSuccess() {
            showPopup('Payment Successful!', 'Your booking has been confirmed. Redirecting to status page...', 'success');
        }

        function showPopup(title, message, type = 'info') {
            const popup = document.createElement('div');
            popup.className = 'popup-overlay';
            
            const iconClass = type === 'success' ? 'fa-check-circle' : 
                             type === 'error' ? 'fa-exclamation-triangle' : 'fa-info-circle';
            
            const color = type === 'success' ? 'var(--success)' : 
                         type === 'error' ? 'var(--danger)' : 'var(--info)';
            
            popup.innerHTML = `
                <div class="popup-content" style="animation: fadeInUp 0.3s ease;">
                    <div class="popup-icon" style="color: ${color};">
                        <i class="fas ${iconClass}"></i>
                    </div>
                    <h3>${title}</h3>
                    <p>${message}</p>
                    <button onclick="closePopup(this)" class="btn btn-primary">OK</button>
                </div>
            `;
            
            document.body.appendChild(popup);
        }

        function closePopup(button) {
            const popup = button.closest('.popup-overlay');
            popup.style.animation = 'fadeOut 0.3s ease';
            setTimeout(() => popup.remove(), 300);
        }

        // Format card number input
        document.addEventListener('DOMContentLoaded', function() {
            initializeNavbar();
            initializeHeader();
            
            document.getElementById('card-number').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\s/g, '').replace(/[^0-9]/gi, '');
                let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
                e.target.value = formattedValue;
            });

            document.getElementById('expiry-date').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length >= 2) {
                    value = value.substring(0, 2) + '/' + value.substring(2, 4);
                }
                e.target.value = value;
            });

            document.getElementById('cvv').addEventListener('input', function(e) {
                e.target.value = e.target.value.replace(/\D/g, '').substring(0, 3);
            });
        });
    </script>

    <style>
        /* Additional styles for popup */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .popup-content {
            background: white;
            padding: 30px;
            border-radius: var(--radius);
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: var(--shadow-lg);
        }

        .popup-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .popup-content h3 {
            margin-bottom: 15px;
            color: var(--dark);
        }

        .popup-content p {
            margin-bottom: 25px;
            color: var(--text-light);
            line-height: 1.5;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        /* Mobile menu toggle */
        .mobile-menu-toggle {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1002;
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        @media (max-width: 992px) {
            .mobile-menu-toggle {
                display: block;
            }
            
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
        }

        /* Profile dropdown styles */
        .profile-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            min-width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: var(--transition);
            z-index: 1000;
        }

        .profile-dropdown.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .profile-dropdown a {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: var(--text);
            text-decoration: none;
            transition: var(--transition);
            font-size: 14px;
        }

        .profile-dropdown a:hover {
            background-color: rgba(67, 97, 238, 0.05);
            color: var(--primary);
        }

        .profile-dropdown a i {
            margin-right: 10px;
            width: 16px;
            font-size: 14px;
        }

        .profile-dropdown hr {
            margin: 8px 0;
            border: none;
            border-top: 1px solid var(--border);
        }
    </style>
</body>
</html>